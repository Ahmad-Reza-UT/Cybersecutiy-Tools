'''                                         '''

    ########################################
    #    Returning banner from a port      #
    #       Ahmad Reza Parsi Zadeh         #
    #        github: ahmad-reza-ut         #
    ########################################
'''                                         '''
'''
            Important Notes:
    Returning banner script is mainly functional
    to find exploits about the soft wares which are running on
    specific scanned ports.
'''
# ------------- Returning banner from a port -------------#
# Importing necessary Packages and Libraries
from Imports import *
#--------------------------------------------------#
def retBanner(ip, port):
    try:
        socket.setdefaulttimeout(1)
        SOCKET = socket.socket()
        SOCKET.connect((ip, port))
        banner = SOCKET.recv(1024)
        return banner
    except:
        return
#--------------------------------------------------#
def main():
    ip = input("Enter the HOST to scan: ")
    choice = int(input("Select: 1. Scan all ports ****** 2. Scan first n ports: "))
    PORTS = int(input("Enter your intended number of ports: ")) if choice == 2 else 65535
    for PORT in range(1, PORTS + 1):
        BANNER = retBanner(ip, PORT)
        if BANNER:
            print("[+]" + ip + "/" + str(PORT) + ": " + BANNER)
#--------------------------------------------------#
if __name__ == "__main__":
    main()

#-------------------- End -------------------------#